# Example configuration file for SendRepo
# Customize the paths, remotes, and other settings as needed.
# Rename this file to config.yaml to use it.

config_sync:
  # Use 'git pull' if your config is in a git repository
  command: "git pull"
  # Or use 'rclone' to sync from a cloud storage provider
  # command: "rclone sync your_remote:path/to/config_folder ."
root: ~/
projects:
  your-project:
    path: "{root}/projects/your-project/"
    remote: user@127.0.0.1:/home/user/your-project/
    port: 22
    backup_dir: /home/user/your-project/.sendrepo/backups/{timestamp}/
    exclude:
      - .git
      - node_modules
      - __pycache__
      - .sendrepo
    # pre_send: |
    #   echo "Pulling latest changes..."
    #   git pull
    # post_send: |
    #   echo "Restarting service..."
    #   ssh -t user@127.0.0.1 "cd /home/user/your-project && sudo docker compose up --build -d"
  
  another-project:
    path: "{root}/projects/another-project/"
    remote: user@127.0.0.1:/home/user/another-project/
    port: 22
    backup_dir: /home/user/another-project/.sendrepo/backups/{timestamp}/
    exclude:
      - .git
      - node_modules
      - __pycache__
      - .sendrepo
    # pre_send: |
    #   echo "Pulling latest changes..."
    #   git pull
    # post_send: |
    #   echo "Restarting service..."
    #   ssh -t user@127.0.0.1 "cd /home/user/another-project && sudo docker compose up --build -d"
  
  # Example project using SSH jump host (reverse tunnel)
  # This uses ProxyJump to tunnel through a bastion host
  # equivalent to: ssh -J user@remote-ip:22 -p 22 user-behind-nat@localhost
  remote-project-via-tunnel:
    path: "{root}/projects/remote-project/"
    remote: user-behind-nat@localhost:/home/user-behind-nat/remote-project/
    ssh_jump_host: "user@remote-ip:22"
    port: 22
    backup_dir: /home/user-behind-nat/remote-project/.sendrepo/backups/{timestamp}/
    exclude:
      - .git
      - node_modules
      - __pycache__
      - .sendrepo
    pre_send: |
      echo "Pulling latest changes..."
      git pull
    post_send: |
      echo "Restarting service..."
      ssh -t -J user@remote-ip:22 -p 22 user-behind-nat@localhost "cd /home/user-behind-nat/remote-project && sudo docker compose up --build -d"